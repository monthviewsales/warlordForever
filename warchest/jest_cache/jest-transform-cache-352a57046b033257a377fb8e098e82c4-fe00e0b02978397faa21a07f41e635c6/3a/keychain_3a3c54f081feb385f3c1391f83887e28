f2ae4cc36f3e6203221e2f5f816cb6c4
/**
 * @module core/keychain
 * @see README.md#key-security
 */

const keytar = require('keytar');
const SERVICE = 'warchest';

/**
 * Save private key to macOS Keychain.
 * @param {string} keychainRef - Reference label for the key.
 * @param {string} privateKey - Private key to save.
 */
async function saveKey(keychainRef, privateKey) {
  await keytar.setPassword(SERVICE, keychainRef, privateKey);
}

/**
 * Retrieve private key from macOS Keychain.
 * @param {string} keychainRef - Reference label for the key.
 * @returns {Promise<string>}
 */
async function getKey(keychainRef) {
  return keytar.getPassword(SERVICE, keychainRef);
}
module.exports = {
  saveKey,
  getKey
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJrZXl0YXIiLCJyZXF1aXJlIiwiU0VSVklDRSIsInNhdmVLZXkiLCJrZXljaGFpblJlZiIsInByaXZhdGVLZXkiLCJzZXRQYXNzd29yZCIsImdldEtleSIsImdldFBhc3N3b3JkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImtleWNoYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQG1vZHVsZSBjb3JlL2tleWNoYWluXG4gKiBAc2VlIFJFQURNRS5tZCNrZXktc2VjdXJpdHlcbiAqL1xuXG5jb25zdCBrZXl0YXIgPSByZXF1aXJlKCdrZXl0YXInKTtcblxuY29uc3QgU0VSVklDRSA9ICd3YXJjaGVzdCc7XG5cbi8qKlxuICogU2F2ZSBwcml2YXRlIGtleSB0byBtYWNPUyBLZXljaGFpbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXljaGFpblJlZiAtIFJlZmVyZW5jZSBsYWJlbCBmb3IgdGhlIGtleS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwcml2YXRlS2V5IC0gUHJpdmF0ZSBrZXkgdG8gc2F2ZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2F2ZUtleShrZXljaGFpblJlZiwgcHJpdmF0ZUtleSkge1xuICBhd2FpdCBrZXl0YXIuc2V0UGFzc3dvcmQoU0VSVklDRSwga2V5Y2hhaW5SZWYsIHByaXZhdGVLZXkpO1xufVxuXG4vKipcbiAqIFJldHJpZXZlIHByaXZhdGUga2V5IGZyb20gbWFjT1MgS2V5Y2hhaW4uXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5Y2hhaW5SZWYgLSBSZWZlcmVuY2UgbGFiZWwgZm9yIHRoZSBrZXkuXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRLZXkoa2V5Y2hhaW5SZWYpIHtcbiAgcmV0dXJuIGtleXRhci5nZXRQYXNzd29yZChTRVJWSUNFLCBrZXljaGFpblJlZik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzYXZlS2V5LFxuICBnZXRLZXlcbn07Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFaEMsTUFBTUMsT0FBTyxHQUFHLFVBQVU7O0FBRTFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlQyxPQUFPQSxDQUFDQyxXQUFXLEVBQUVDLFVBQVUsRUFBRTtFQUM5QyxNQUFNTCxNQUFNLENBQUNNLFdBQVcsQ0FBQ0osT0FBTyxFQUFFRSxXQUFXLEVBQUVDLFVBQVUsQ0FBQztBQUM1RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZUUsTUFBTUEsQ0FBQ0gsV0FBVyxFQUFFO0VBQ2pDLE9BQU9KLE1BQU0sQ0FBQ1EsV0FBVyxDQUFDTixPQUFPLEVBQUVFLFdBQVcsQ0FBQztBQUNqRDtBQUVBSyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNmUCxPQUFPO0VBQ1BJO0FBQ0YsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==
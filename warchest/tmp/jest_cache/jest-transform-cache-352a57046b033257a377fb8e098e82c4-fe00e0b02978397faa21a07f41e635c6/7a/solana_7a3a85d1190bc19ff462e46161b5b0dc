d6fa5b49ea047f44fb78246b223f25d0
/**
 * @module core/solana
 * @see README.md#rpc--api
 */

// import RPC and keypair signer utilities from kit
const {
  createKeyPairSignerFromBytes
} = require('@solana/kit');
const nacl = require('tweetnacl');
const EventBus = require('./eventBus');
const keychain = require('./keychain');
const errorHandler = require('./errorHandler');
const {
  Client
} = require('@solana-tracker/data-api');
const {
  PrismaClient
} = require('@prisma/client');
const prisma = new PrismaClient();

// initialize Data API client
const dataApiClient = new Client({
  apiKey: process.env.SOLANA_API_KEY
});

/**
 * Create a new Solana wallet.
 * @returns {Promise<{publicKey: string, keychainRef: string}>}
 */
async function createWallet(name) {
  try {
    // generate raw Ed25519 keypair
    const rawKeyPair = nacl.sign.keyPair();
    // wrap as a Kit signer to obtain address
    const signer = await createKeyPairSignerFromBytes(rawKeyPair.secretKey);
    const publicKey = signer.address;
    // serialize private key bytes to hex
    const privateKeyHex = Buffer.from(rawKeyPair.secretKey).toString('hex');
    // save to keychain
    await keychain.saveKey(name, privateKeyHex);
    return {
      publicKey,
      keychainRef: name
    };
  } catch (err) {
    errorHandler(err);
    throw err;
  }
}

/**
 * Retrieve the private key for a given public key.
 * @param {string} publicKey - Public key of the wallet.
 * @returns {Promise<string>}
 */
async function getPrivateKey(publicKey) {
  try {
    return await keychain.getKey(publicKey);
  } catch (err) {
    errorHandler(err);
    throw err;
  }
}

/**
 * Scan token accounts for a wallet.
 * @param {string} publicKey - Public key of the wallet.
 */
async function scanAccounts(publicKey) {
  EventBus.emit('solana.scan.start', {
    publicKey
  });
  try {
    const data = await dataApiClient.getWallet(publicKey);
    // Persist scan and related data
    const walletRecord = await prisma.wallet.findUnique({
      where: {
        publicKey
      }
    });
    if (!walletRecord) {
      throw new Error(`Wallet not found in DB: ${publicKey}`);
    }
    const walletId = walletRecord.id;

    // 1. Upsert token metadata
    for (const tokenObj of data.tokens) {
      await prisma.token.upsert({
        where: {
          mint: tokenObj.token.mint
        },
        create: {
          mint: tokenObj.token.mint,
          name: tokenObj.token.name,
          symbol: tokenObj.token.symbol,
          uri: tokenObj.token.uri || null,
          decimals: tokenObj.token.decimals,
          image: tokenObj.token.image || null
          // any other Token fieldsâ€¦
        },
        update: {
          name: tokenObj.token.name,
          symbol: tokenObj.token.symbol,
          uri: tokenObj.token.uri || null,
          decimals: tokenObj.token.decimals,
          image: tokenObj.token.image || null
          // etc.
        }
      });

      // 2. Upsert pools
      for (const pool of tokenObj.pools) {
        await prisma.pool.upsert({
          where: {
            poolId: pool.poolId
          },
          create: {
            poolId: pool.poolId,
            tokenMint: pool.tokenAddress,
            market: pool.market,
            liquidityQuote: pool.liquidity.quote,
            liquidityUsd: pool.liquidity.usd,
            priceQuote: pool.price.quote,
            priceUsd: pool.price.usd,
            tokenSupply: pool.tokenSupply,
            lpBurn: pool.lpBurn,
            marketCapQuote: pool.marketCap.quote,
            marketCapUsd: pool.marketCap.usd,
            quoteToken: pool.quoteToken,
            decimals: pool.decimals,
            deployer: pool.deployer || null,
            lastUpdated: new Date(pool.lastUpdated),
            createdAt: pool.createdAt ? new Date(pool.createdAt) : null,
            token: {
              connect: {
                mint: pool.tokenAddress
              }
            }
          },
          update: {
            liquidityQuote: pool.liquidity.quote,
            liquidityUsd: pool.liquidity.usd,
            priceQuote: pool.price.quote,
            priceUsd: pool.price.usd,
            tokenSupply: pool.tokenSupply,
            lpBurn: pool.lpBurn,
            marketCapQuote: pool.marketCap.quote,
            marketCapUsd: pool.marketCap.usd,
            deployer: pool.deployer || null,
            lastUpdated: new Date(pool.lastUpdated)
          }
        });
      }

      // 3. Upsert balance
      const balanceRecord = await prisma.balance.upsert({
        where: {
          walletId_tokenMint: {
            walletId,
            tokenMint: tokenObj.token.mint
          }
        },
        create: {
          walletId,
          tokenMint: tokenObj.token.mint,
          amount: tokenObj.balance,
          value: tokenObj.value,
          holders: tokenObj.holders,
          buys: tokenObj.buys,
          sells: tokenObj.sells,
          txns: tokenObj.txns
        },
        update: {
          amount: tokenObj.balance,
          value: tokenObj.value,
          holders: tokenObj.holders,
          buys: tokenObj.buys,
          sells: tokenObj.sells,
          txns: tokenObj.txns
        }
      });

      // 4. Upsert price events
      for (const [interval, ev] of Object.entries(tokenObj.events)) {
        await prisma.priceEvent.upsert({
          where: {
            balanceId_intervalLabel: {
              balanceId: balanceRecord.id,
              intervalLabel: interval
            }
          },
          create: {
            balanceId: balanceRecord.id,
            intervalLabel: interval,
            pctChange: ev.priceChangePercentage
          },
          update: {
            pctChange: ev.priceChangePercentage
          }
        });
      }

      // 5. Upsert risk profile
      await prisma.riskProfile.upsert({
        where: {
          balanceId: balanceRecord.id
        },
        create: {
          balanceId: balanceRecord.id,
          rugged: tokenObj.risk.rugged,
          risksJson: tokenObj.risk.risks,
          score: tokenObj.risk.score,
          jupiterVerified: tokenObj.risk.jupiterVerified
        },
        update: {
          rugged: tokenObj.risk.rugged,
          risksJson: tokenObj.risk.risks,
          score: tokenObj.risk.score,
          jupiterVerified: tokenObj.risk.jupiterVerified
        }
      });
    }

    // Extract detailed token holdings
    const tokens = data.tokens.map(item => ({
      mint: item.token.mint,
      symbol: item.token.symbol,
      name: item.token.name || item.token.symbol,
      balance: item.balance,
      value: item.value,
      pools: item.pools,
      events: item.events,
      risk: item.risk,
      buys: item.buys,
      sells: item.sells,
      txns: item.txns,
      holders: item.holders
    }));
    EventBus.emit('solana.scan.complete', {
      publicKey,
      tokens
    });
    return tokens;
  } catch (err) {
    errorHandler(err);
    throw err;
  }
}

/**
 * Calculate P&L for a wallet.
 * @param {string} publicKey - Public key of the wallet.
 * @returns {Promise<Object>} Full P&L data including tokens and summary.
 */
async function calculatePnl(publicKey) {
  EventBus.emit('solana.pnl.start', {
    publicKey
  });
  try {
    const data = await dataApiClient.getWalletPnL(publicKey, true, true, false);
    // Persist PnL snapshot
    const walletRecord = await prisma.wallet.findUnique({
      where: {
        publicKey
      }
    });
    if (!walletRecord) {
      throw new Error(`Wallet not found in DB: ${publicKey}`);
    }
    const pnlScan = await prisma.pnlScan.create({
      data: {
        walletId: walletRecord.id,
        realized: data.summary.realized,
        unrealized: data.summary.unrealized,
        total: data.summary.total,
        totalInvested: data.summary.totalInvested,
        averageBuyAmount: data.summary.averageBuyAmount,
        totalWins: data.summary.totalWins,
        totalLosses: data.summary.totalLosses,
        winPercentage: data.summary.winPercentage,
        lossPercentage: data.summary.lossPercentage,
        pnlTokens: {
          create: data.tokens.map(tok => ({
            tokenMint: tok.token,
            holding: tok.holding,
            held: tok.held,
            sold: tok.sold,
            realized: tok.realized,
            unrealized: tok.unrealized,
            total: tok.total,
            totalSold: tok.total_sold,
            totalInvested: tok.total_invested,
            averageBuyAmount: tok.average_buy_amount,
            currentValue: tok.current_value,
            costBasis: tok.cost_basis
          }))
        }
      }
    });
    EventBus.emit('solana.pnl.complete', {
      publicKey,
      summary: data.summary,
      tokens: data.tokens
    });
    return data;
  } catch (err) {
    errorHandler(err);
    throw err;
  }
}
module.exports = {
  createWallet,
  getPrivateKey,
  scanAccounts,
  calculatePnl
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVLZXlQYWlyU2lnbmVyRnJvbUJ5dGVzIiwicmVxdWlyZSIsIm5hY2wiLCJFdmVudEJ1cyIsImtleWNoYWluIiwiZXJyb3JIYW5kbGVyIiwiQ2xpZW50IiwiUHJpc21hQ2xpZW50IiwicHJpc21hIiwiZGF0YUFwaUNsaWVudCIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJTT0xBTkFfQVBJX0tFWSIsImNyZWF0ZVdhbGxldCIsIm5hbWUiLCJyYXdLZXlQYWlyIiwic2lnbiIsImtleVBhaXIiLCJzaWduZXIiLCJzZWNyZXRLZXkiLCJwdWJsaWNLZXkiLCJhZGRyZXNzIiwicHJpdmF0ZUtleUhleCIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInNhdmVLZXkiLCJrZXljaGFpblJlZiIsImVyciIsImdldFByaXZhdGVLZXkiLCJnZXRLZXkiLCJzY2FuQWNjb3VudHMiLCJlbWl0IiwiZGF0YSIsImdldFdhbGxldCIsIndhbGxldFJlY29yZCIsIndhbGxldCIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsIkVycm9yIiwid2FsbGV0SWQiLCJpZCIsInRva2VuT2JqIiwidG9rZW5zIiwidG9rZW4iLCJ1cHNlcnQiLCJtaW50IiwiY3JlYXRlIiwic3ltYm9sIiwidXJpIiwiZGVjaW1hbHMiLCJpbWFnZSIsInVwZGF0ZSIsInBvb2wiLCJwb29scyIsInBvb2xJZCIsInRva2VuTWludCIsInRva2VuQWRkcmVzcyIsIm1hcmtldCIsImxpcXVpZGl0eVF1b3RlIiwibGlxdWlkaXR5IiwicXVvdGUiLCJsaXF1aWRpdHlVc2QiLCJ1c2QiLCJwcmljZVF1b3RlIiwicHJpY2UiLCJwcmljZVVzZCIsInRva2VuU3VwcGx5IiwibHBCdXJuIiwibWFya2V0Q2FwUXVvdGUiLCJtYXJrZXRDYXAiLCJtYXJrZXRDYXBVc2QiLCJxdW90ZVRva2VuIiwiZGVwbG95ZXIiLCJsYXN0VXBkYXRlZCIsIkRhdGUiLCJjcmVhdGVkQXQiLCJjb25uZWN0IiwiYmFsYW5jZVJlY29yZCIsImJhbGFuY2UiLCJ3YWxsZXRJZF90b2tlbk1pbnQiLCJhbW91bnQiLCJ2YWx1ZSIsImhvbGRlcnMiLCJidXlzIiwic2VsbHMiLCJ0eG5zIiwiaW50ZXJ2YWwiLCJldiIsIk9iamVjdCIsImVudHJpZXMiLCJldmVudHMiLCJwcmljZUV2ZW50IiwiYmFsYW5jZUlkX2ludGVydmFsTGFiZWwiLCJiYWxhbmNlSWQiLCJpbnRlcnZhbExhYmVsIiwicGN0Q2hhbmdlIiwicHJpY2VDaGFuZ2VQZXJjZW50YWdlIiwicmlza1Byb2ZpbGUiLCJydWdnZWQiLCJyaXNrIiwicmlza3NKc29uIiwicmlza3MiLCJzY29yZSIsImp1cGl0ZXJWZXJpZmllZCIsIm1hcCIsIml0ZW0iLCJjYWxjdWxhdGVQbmwiLCJnZXRXYWxsZXRQbkwiLCJwbmxTY2FuIiwicmVhbGl6ZWQiLCJzdW1tYXJ5IiwidW5yZWFsaXplZCIsInRvdGFsIiwidG90YWxJbnZlc3RlZCIsImF2ZXJhZ2VCdXlBbW91bnQiLCJ0b3RhbFdpbnMiLCJ0b3RhbExvc3NlcyIsIndpblBlcmNlbnRhZ2UiLCJsb3NzUGVyY2VudGFnZSIsInBubFRva2VucyIsInRvayIsImhvbGRpbmciLCJoZWxkIiwic29sZCIsInRvdGFsU29sZCIsInRvdGFsX3NvbGQiLCJ0b3RhbF9pbnZlc3RlZCIsImF2ZXJhZ2VfYnV5X2Ftb3VudCIsImN1cnJlbnRWYWx1ZSIsImN1cnJlbnRfdmFsdWUiLCJjb3N0QmFzaXMiLCJjb3N0X2Jhc2lzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNvbGFuYS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBtb2R1bGUgY29yZS9zb2xhbmFcbiAqIEBzZWUgUkVBRE1FLm1kI3JwYy0tYXBpXG4gKi9cblxuLy8gaW1wb3J0IFJQQyBhbmQga2V5cGFpciBzaWduZXIgdXRpbGl0aWVzIGZyb20ga2l0XG5jb25zdCB7IGNyZWF0ZUtleVBhaXJTaWduZXJGcm9tQnl0ZXMgfSA9IHJlcXVpcmUoJ0Bzb2xhbmEva2l0Jyk7XG5jb25zdCBuYWNsID0gcmVxdWlyZSgndHdlZXRuYWNsJyk7XG5jb25zdCBFdmVudEJ1cyA9IHJlcXVpcmUoJy4vZXZlbnRCdXMnKTtcbmNvbnN0IGtleWNoYWluID0gcmVxdWlyZSgnLi9rZXljaGFpbicpO1xuY29uc3QgZXJyb3JIYW5kbGVyID0gcmVxdWlyZSgnLi9lcnJvckhhbmRsZXInKTtcbmNvbnN0IHsgQ2xpZW50IH0gPSByZXF1aXJlKCdAc29sYW5hLXRyYWNrZXIvZGF0YS1hcGknKTtcbmNvbnN0IHsgUHJpc21hQ2xpZW50IH0gPSByZXF1aXJlKCdAcHJpc21hL2NsaWVudCcpO1xuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuXG4vLyBpbml0aWFsaXplIERhdGEgQVBJIGNsaWVudFxuY29uc3QgZGF0YUFwaUNsaWVudCA9IG5ldyBDbGllbnQoeyBhcGlLZXk6IHByb2Nlc3MuZW52LlNPTEFOQV9BUElfS0VZIH0pO1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBTb2xhbmEgd2FsbGV0LlxuICogQHJldHVybnMge1Byb21pc2U8e3B1YmxpY0tleTogc3RyaW5nLCBrZXljaGFpblJlZjogc3RyaW5nfT59XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVdhbGxldChuYW1lKSB7XG4gIHRyeSB7XG4gICAgLy8gZ2VuZXJhdGUgcmF3IEVkMjU1MTkga2V5cGFpclxuICAgIGNvbnN0IHJhd0tleVBhaXIgPSBuYWNsLnNpZ24ua2V5UGFpcigpO1xuICAgIC8vIHdyYXAgYXMgYSBLaXQgc2lnbmVyIHRvIG9idGFpbiBhZGRyZXNzXG4gICAgY29uc3Qgc2lnbmVyID0gYXdhaXQgY3JlYXRlS2V5UGFpclNpZ25lckZyb21CeXRlcyhyYXdLZXlQYWlyLnNlY3JldEtleSk7XG4gICAgY29uc3QgcHVibGljS2V5ID0gc2lnbmVyLmFkZHJlc3M7XG4gICAgLy8gc2VyaWFsaXplIHByaXZhdGUga2V5IGJ5dGVzIHRvIGhleFxuICAgIGNvbnN0IHByaXZhdGVLZXlIZXggPSBCdWZmZXIuZnJvbShyYXdLZXlQYWlyLnNlY3JldEtleSkudG9TdHJpbmcoJ2hleCcpO1xuICAgIC8vIHNhdmUgdG8ga2V5Y2hhaW5cbiAgICBhd2FpdCBrZXljaGFpbi5zYXZlS2V5KG5hbWUsIHByaXZhdGVLZXlIZXgpO1xuICAgIHJldHVybiB7IHB1YmxpY0tleSwga2V5Y2hhaW5SZWY6IG5hbWUgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZXJyb3JIYW5kbGVyKGVycik7XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbi8qKlxuICogUmV0cmlldmUgdGhlIHByaXZhdGUga2V5IGZvciBhIGdpdmVuIHB1YmxpYyBrZXkuXG4gKiBAcGFyYW0ge3N0cmluZ30gcHVibGljS2V5IC0gUHVibGljIGtleSBvZiB0aGUgd2FsbGV0LlxuICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0UHJpdmF0ZUtleShwdWJsaWNLZXkpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQga2V5Y2hhaW4uZ2V0S2V5KHB1YmxpY0tleSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGVycm9ySGFuZGxlcihlcnIpO1xuICAgIHRocm93IGVycjtcbiAgfVxufVxuXG5cbi8qKlxuICogU2NhbiB0b2tlbiBhY2NvdW50cyBmb3IgYSB3YWxsZXQuXG4gKiBAcGFyYW0ge3N0cmluZ30gcHVibGljS2V5IC0gUHVibGljIGtleSBvZiB0aGUgd2FsbGV0LlxuICovXG5hc3luYyBmdW5jdGlvbiBzY2FuQWNjb3VudHMocHVibGljS2V5KSB7XG4gIEV2ZW50QnVzLmVtaXQoJ3NvbGFuYS5zY2FuLnN0YXJ0JywgeyBwdWJsaWNLZXkgfSk7XG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGRhdGFBcGlDbGllbnQuZ2V0V2FsbGV0KHB1YmxpY0tleSk7XG4gICAgLy8gUGVyc2lzdCBzY2FuIGFuZCByZWxhdGVkIGRhdGFcbiAgICBjb25zdCB3YWxsZXRSZWNvcmQgPSBhd2FpdCBwcmlzbWEud2FsbGV0LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBwdWJsaWNLZXkgfSB9KTtcbiAgICBpZiAoIXdhbGxldFJlY29yZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXYWxsZXQgbm90IGZvdW5kIGluIERCOiAke3B1YmxpY0tleX1gKTtcbiAgICB9XG4gICAgY29uc3Qgd2FsbGV0SWQgPSB3YWxsZXRSZWNvcmQuaWQ7XG5cbiAgICAvLyAxLiBVcHNlcnQgdG9rZW4gbWV0YWRhdGFcbiAgICBmb3IgKGNvbnN0IHRva2VuT2JqIG9mIGRhdGEudG9rZW5zKSB7XG4gICAgICBhd2FpdCBwcmlzbWEudG9rZW4udXBzZXJ0KHtcbiAgICAgICAgd2hlcmU6IHsgbWludDogdG9rZW5PYmoudG9rZW4ubWludCB9LFxuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBtaW50OiB0b2tlbk9iai50b2tlbi5taW50LFxuICAgICAgICAgIG5hbWU6IHRva2VuT2JqLnRva2VuLm5hbWUsXG4gICAgICAgICAgc3ltYm9sOiB0b2tlbk9iai50b2tlbi5zeW1ib2wsXG4gICAgICAgICAgdXJpOiB0b2tlbk9iai50b2tlbi51cmkgfHwgbnVsbCxcbiAgICAgICAgICBkZWNpbWFsczogdG9rZW5PYmoudG9rZW4uZGVjaW1hbHMsXG4gICAgICAgICAgaW1hZ2U6IHRva2VuT2JqLnRva2VuLmltYWdlIHx8IG51bGwsXG4gICAgICAgICAgLy8gYW55IG90aGVyIFRva2VuIGZpZWxkc+KAplxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBuYW1lOiB0b2tlbk9iai50b2tlbi5uYW1lLFxuICAgICAgICAgIHN5bWJvbDogdG9rZW5PYmoudG9rZW4uc3ltYm9sLFxuICAgICAgICAgIHVyaTogdG9rZW5PYmoudG9rZW4udXJpIHx8IG51bGwsXG4gICAgICAgICAgZGVjaW1hbHM6IHRva2VuT2JqLnRva2VuLmRlY2ltYWxzLFxuICAgICAgICAgIGltYWdlOiB0b2tlbk9iai50b2tlbi5pbWFnZSB8fCBudWxsLFxuICAgICAgICAgIC8vIGV0Yy5cbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyAyLiBVcHNlcnQgcG9vbHNcbiAgICAgIGZvciAoY29uc3QgcG9vbCBvZiB0b2tlbk9iai5wb29scykge1xuICAgICAgICBhd2FpdCBwcmlzbWEucG9vbC51cHNlcnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHBvb2xJZDogcG9vbC5wb29sSWQgfSxcbiAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgIHBvb2xJZDogcG9vbC5wb29sSWQsXG4gICAgICAgICAgICB0b2tlbk1pbnQ6IHBvb2wudG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgbWFya2V0OiBwb29sLm1hcmtldCxcbiAgICAgICAgICAgIGxpcXVpZGl0eVF1b3RlOiBwb29sLmxpcXVpZGl0eS5xdW90ZSxcbiAgICAgICAgICAgIGxpcXVpZGl0eVVzZDogcG9vbC5saXF1aWRpdHkudXNkLFxuICAgICAgICAgICAgcHJpY2VRdW90ZTogcG9vbC5wcmljZS5xdW90ZSxcbiAgICAgICAgICAgIHByaWNlVXNkOiBwb29sLnByaWNlLnVzZCxcbiAgICAgICAgICAgIHRva2VuU3VwcGx5OiBwb29sLnRva2VuU3VwcGx5LFxuICAgICAgICAgICAgbHBCdXJuOiBwb29sLmxwQnVybixcbiAgICAgICAgICAgIG1hcmtldENhcFF1b3RlOiBwb29sLm1hcmtldENhcC5xdW90ZSxcbiAgICAgICAgICAgIG1hcmtldENhcFVzZDogcG9vbC5tYXJrZXRDYXAudXNkLFxuICAgICAgICAgICAgcXVvdGVUb2tlbjogcG9vbC5xdW90ZVRva2VuLFxuICAgICAgICAgICAgZGVjaW1hbHM6IHBvb2wuZGVjaW1hbHMsXG4gICAgICAgICAgICBkZXBsb3llcjogcG9vbC5kZXBsb3llciB8fCBudWxsLFxuICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKHBvb2wubGFzdFVwZGF0ZWQpLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBwb29sLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKHBvb2wuY3JlYXRlZEF0KSA6IG51bGwsXG4gICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgICAgICAgbWludDogcG9vbC50b2tlbkFkZHJlc3NcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgbGlxdWlkaXR5UXVvdGU6IHBvb2wubGlxdWlkaXR5LnF1b3RlLFxuICAgICAgICAgICAgbGlxdWlkaXR5VXNkOiBwb29sLmxpcXVpZGl0eS51c2QsXG4gICAgICAgICAgICBwcmljZVF1b3RlOiBwb29sLnByaWNlLnF1b3RlLFxuICAgICAgICAgICAgcHJpY2VVc2Q6IHBvb2wucHJpY2UudXNkLFxuICAgICAgICAgICAgdG9rZW5TdXBwbHk6IHBvb2wudG9rZW5TdXBwbHksXG4gICAgICAgICAgICBscEJ1cm46IHBvb2wubHBCdXJuLFxuICAgICAgICAgICAgbWFya2V0Q2FwUXVvdGU6IHBvb2wubWFya2V0Q2FwLnF1b3RlLFxuICAgICAgICAgICAgbWFya2V0Q2FwVXNkOiBwb29sLm1hcmtldENhcC51c2QsXG4gICAgICAgICAgICBkZXBsb3llcjogcG9vbC5kZXBsb3llciB8fCBudWxsLFxuICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKHBvb2wubGFzdFVwZGF0ZWQpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyAzLiBVcHNlcnQgYmFsYW5jZVxuICAgICAgY29uc3QgYmFsYW5jZVJlY29yZCA9IGF3YWl0IHByaXNtYS5iYWxhbmNlLnVwc2VydCh7XG4gICAgICAgIHdoZXJlOiB7IHdhbGxldElkX3Rva2VuTWludDogeyB3YWxsZXRJZCwgdG9rZW5NaW50OiB0b2tlbk9iai50b2tlbi5taW50IH0gfSxcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgd2FsbGV0SWQsXG4gICAgICAgICAgdG9rZW5NaW50OiB0b2tlbk9iai50b2tlbi5taW50LFxuICAgICAgICAgIGFtb3VudDogdG9rZW5PYmouYmFsYW5jZSxcbiAgICAgICAgICB2YWx1ZTogdG9rZW5PYmoudmFsdWUsXG4gICAgICAgICAgaG9sZGVyczogdG9rZW5PYmouaG9sZGVycyxcbiAgICAgICAgICBidXlzOiB0b2tlbk9iai5idXlzLFxuICAgICAgICAgIHNlbGxzOiB0b2tlbk9iai5zZWxscyxcbiAgICAgICAgICB0eG5zOiB0b2tlbk9iai50eG5zLFxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBhbW91bnQ6IHRva2VuT2JqLmJhbGFuY2UsXG4gICAgICAgICAgdmFsdWU6IHRva2VuT2JqLnZhbHVlLFxuICAgICAgICAgIGhvbGRlcnM6IHRva2VuT2JqLmhvbGRlcnMsXG4gICAgICAgICAgYnV5czogdG9rZW5PYmouYnV5cyxcbiAgICAgICAgICBzZWxsczogdG9rZW5PYmouc2VsbHMsXG4gICAgICAgICAgdHhuczogdG9rZW5PYmoudHhucyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyA0LiBVcHNlcnQgcHJpY2UgZXZlbnRzXG4gICAgICBmb3IgKGNvbnN0IFtpbnRlcnZhbCwgZXZdIG9mIE9iamVjdC5lbnRyaWVzKHRva2VuT2JqLmV2ZW50cykpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLnByaWNlRXZlbnQudXBzZXJ0KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgYmFsYW5jZUlkX2ludGVydmFsTGFiZWw6IHtcbiAgICAgICAgICAgICAgYmFsYW5jZUlkOiBiYWxhbmNlUmVjb3JkLmlkLFxuICAgICAgICAgICAgICBpbnRlcnZhbExhYmVsOiBpbnRlcnZhbCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgIGJhbGFuY2VJZDogYmFsYW5jZVJlY29yZC5pZCxcbiAgICAgICAgICAgIGludGVydmFsTGFiZWw6IGludGVydmFsLFxuICAgICAgICAgICAgcGN0Q2hhbmdlOiBldi5wcmljZUNoYW5nZVBlcmNlbnRhZ2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgIHBjdENoYW5nZTogZXYucHJpY2VDaGFuZ2VQZXJjZW50YWdlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyA1LiBVcHNlcnQgcmlzayBwcm9maWxlXG4gICAgICBhd2FpdCBwcmlzbWEucmlza1Byb2ZpbGUudXBzZXJ0KHtcbiAgICAgICAgd2hlcmU6IHsgYmFsYW5jZUlkOiBiYWxhbmNlUmVjb3JkLmlkIH0sXG4gICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgIGJhbGFuY2VJZDogYmFsYW5jZVJlY29yZC5pZCxcbiAgICAgICAgICBydWdnZWQ6IHRva2VuT2JqLnJpc2sucnVnZ2VkLFxuICAgICAgICAgIHJpc2tzSnNvbjogdG9rZW5PYmoucmlzay5yaXNrcyxcbiAgICAgICAgICBzY29yZTogdG9rZW5PYmoucmlzay5zY29yZSxcbiAgICAgICAgICBqdXBpdGVyVmVyaWZpZWQ6IHRva2VuT2JqLnJpc2suanVwaXRlclZlcmlmaWVkLFxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBydWdnZWQ6IHRva2VuT2JqLnJpc2sucnVnZ2VkLFxuICAgICAgICAgIHJpc2tzSnNvbjogdG9rZW5PYmoucmlzay5yaXNrcyxcbiAgICAgICAgICBzY29yZTogdG9rZW5PYmoucmlzay5zY29yZSxcbiAgICAgICAgICBqdXBpdGVyVmVyaWZpZWQ6IHRva2VuT2JqLnJpc2suanVwaXRlclZlcmlmaWVkLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCBkZXRhaWxlZCB0b2tlbiBob2xkaW5nc1xuICAgIGNvbnN0IHRva2VucyA9IGRhdGEudG9rZW5zLm1hcChpdGVtID0+ICh7XG4gICAgICBtaW50OiBpdGVtLnRva2VuLm1pbnQsXG4gICAgICBzeW1ib2w6IGl0ZW0udG9rZW4uc3ltYm9sLFxuICAgICAgbmFtZTogaXRlbS50b2tlbi5uYW1lIHx8IGl0ZW0udG9rZW4uc3ltYm9sLFxuICAgICAgYmFsYW5jZTogaXRlbS5iYWxhbmNlLFxuICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICBwb29sczogaXRlbS5wb29scyxcbiAgICAgIGV2ZW50czogaXRlbS5ldmVudHMsXG4gICAgICByaXNrOiBpdGVtLnJpc2ssXG4gICAgICBidXlzOiBpdGVtLmJ1eXMsXG4gICAgICBzZWxsczogaXRlbS5zZWxscyxcbiAgICAgIHR4bnM6IGl0ZW0udHhucyxcbiAgICAgIGhvbGRlcnM6IGl0ZW0uaG9sZGVyc1xuICAgIH0pKTtcbiAgICBFdmVudEJ1cy5lbWl0KCdzb2xhbmEuc2Nhbi5jb21wbGV0ZScsIHsgcHVibGljS2V5LCB0b2tlbnMgfSk7XG4gICAgcmV0dXJuIHRva2VucztcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZXJyb3JIYW5kbGVyKGVycik7XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIFAmTCBmb3IgYSB3YWxsZXQuXG4gKiBAcGFyYW0ge3N0cmluZ30gcHVibGljS2V5IC0gUHVibGljIGtleSBvZiB0aGUgd2FsbGV0LlxuICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gRnVsbCBQJkwgZGF0YSBpbmNsdWRpbmcgdG9rZW5zIGFuZCBzdW1tYXJ5LlxuICovXG5hc3luYyBmdW5jdGlvbiBjYWxjdWxhdGVQbmwocHVibGljS2V5KSB7XG4gIEV2ZW50QnVzLmVtaXQoJ3NvbGFuYS5wbmwuc3RhcnQnLCB7IHB1YmxpY0tleSB9KTtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgZGF0YUFwaUNsaWVudC5nZXRXYWxsZXRQbkwocHVibGljS2V5LCB0cnVlLCB0cnVlLCBmYWxzZSk7XG4gICAgLy8gUGVyc2lzdCBQbkwgc25hcHNob3RcbiAgICBjb25zdCB3YWxsZXRSZWNvcmQgPSBhd2FpdCBwcmlzbWEud2FsbGV0LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBwdWJsaWNLZXkgfSB9KTtcbiAgICBpZiAoIXdhbGxldFJlY29yZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXYWxsZXQgbm90IGZvdW5kIGluIERCOiAke3B1YmxpY0tleX1gKTtcbiAgICB9XG4gICAgY29uc3QgcG5sU2NhbiA9IGF3YWl0IHByaXNtYS5wbmxTY2FuLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIHdhbGxldElkOiB3YWxsZXRSZWNvcmQuaWQsXG4gICAgICAgIHJlYWxpemVkOiBkYXRhLnN1bW1hcnkucmVhbGl6ZWQsXG4gICAgICAgIHVucmVhbGl6ZWQ6IGRhdGEuc3VtbWFyeS51bnJlYWxpemVkLFxuICAgICAgICB0b3RhbDogZGF0YS5zdW1tYXJ5LnRvdGFsLFxuICAgICAgICB0b3RhbEludmVzdGVkOiBkYXRhLnN1bW1hcnkudG90YWxJbnZlc3RlZCxcbiAgICAgICAgYXZlcmFnZUJ1eUFtb3VudDogZGF0YS5zdW1tYXJ5LmF2ZXJhZ2VCdXlBbW91bnQsXG4gICAgICAgIHRvdGFsV2luczogZGF0YS5zdW1tYXJ5LnRvdGFsV2lucyxcbiAgICAgICAgdG90YWxMb3NzZXM6IGRhdGEuc3VtbWFyeS50b3RhbExvc3NlcyxcbiAgICAgICAgd2luUGVyY2VudGFnZTogZGF0YS5zdW1tYXJ5LndpblBlcmNlbnRhZ2UsXG4gICAgICAgIGxvc3NQZXJjZW50YWdlOiBkYXRhLnN1bW1hcnkubG9zc1BlcmNlbnRhZ2UsXG4gICAgICAgIHBubFRva2Vuczoge1xuICAgICAgICAgIGNyZWF0ZTogZGF0YS50b2tlbnMubWFwKHRvayA9PiAoe1xuICAgICAgICAgICAgdG9rZW5NaW50OiB0b2sudG9rZW4sXG4gICAgICAgICAgICBob2xkaW5nOiB0b2suaG9sZGluZyxcbiAgICAgICAgICAgIGhlbGQ6IHRvay5oZWxkLFxuICAgICAgICAgICAgc29sZDogdG9rLnNvbGQsXG4gICAgICAgICAgICByZWFsaXplZDogdG9rLnJlYWxpemVkLFxuICAgICAgICAgICAgdW5yZWFsaXplZDogdG9rLnVucmVhbGl6ZWQsXG4gICAgICAgICAgICB0b3RhbDogdG9rLnRvdGFsLFxuICAgICAgICAgICAgdG90YWxTb2xkOiB0b2sudG90YWxfc29sZCxcbiAgICAgICAgICAgIHRvdGFsSW52ZXN0ZWQ6IHRvay50b3RhbF9pbnZlc3RlZCxcbiAgICAgICAgICAgIGF2ZXJhZ2VCdXlBbW91bnQ6IHRvay5hdmVyYWdlX2J1eV9hbW91bnQsXG4gICAgICAgICAgICBjdXJyZW50VmFsdWU6IHRvay5jdXJyZW50X3ZhbHVlLFxuICAgICAgICAgICAgY29zdEJhc2lzOiB0b2suY29zdF9iYXNpcyxcbiAgICAgICAgICB9KSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIEV2ZW50QnVzLmVtaXQoJ3NvbGFuYS5wbmwuY29tcGxldGUnLCB7XG4gICAgICBwdWJsaWNLZXksXG4gICAgICBzdW1tYXJ5OiBkYXRhLnN1bW1hcnksXG4gICAgICB0b2tlbnM6IGRhdGEudG9rZW5zXG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGVycm9ySGFuZGxlcihlcnIpO1xuICAgIHRocm93IGVycjtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY3JlYXRlV2FsbGV0LFxuICBnZXRQcml2YXRlS2V5LFxuICBzY2FuQWNjb3VudHMsXG4gIGNhbGN1bGF0ZVBubFxufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTTtFQUFFQTtBQUE2QixDQUFDLEdBQUdDLE9BQU8sQ0FBQyxhQUFhLENBQUM7QUFDL0QsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ2pDLE1BQU1FLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFlBQVksQ0FBQztBQUN0QyxNQUFN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